sorry if this is unreadable dogwater
like 30% of this is just hacks to get the other 70% to work properly
